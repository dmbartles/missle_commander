/*! For license information please see main.bb7ccf1a.js.LICENSE.txt */
(()=>{"use strict";var e={672(e,t,s){var r=s(43);function i(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var s=2;s<arguments.length;s++)t+="&args[]="+encodeURIComponent(arguments[s])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function o(){}var n={d:{f:o,r:function(){throw Error(i(522))},D:o,C:o,L:o,m:o,X:o,S:o,M:o},p:0,findDOMNode:null},l=Symbol.for("react.portal");var a=r.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function c(e,t){return"font"===e?"":"string"===typeof t?"use-credentials"===t?t:"":void 0}t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=n,t.createPortal=function(e,t){var s=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!t||1!==t.nodeType&&9!==t.nodeType&&11!==t.nodeType)throw Error(i(299));return function(e,t,s){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:l,key:null==r?null:""+r,children:e,containerInfo:t,implementation:s}}(e,t,null,s)},t.flushSync=function(e){var t=a.T,s=n.p;try{if(a.T=null,n.p=2,e)return e()}finally{a.T=t,n.p=s,n.d.f()}},t.preconnect=function(e,t){"string"===typeof e&&(t?t="string"===typeof(t=t.crossOrigin)?"use-credentials"===t?t:"":void 0:t=null,n.d.C(e,t))},t.prefetchDNS=function(e){"string"===typeof e&&n.d.D(e)},t.preinit=function(e,t){if("string"===typeof e&&t&&"string"===typeof t.as){var s=t.as,r=c(s,t.crossOrigin),i="string"===typeof t.integrity?t.integrity:void 0,o="string"===typeof t.fetchPriority?t.fetchPriority:void 0;"style"===s?n.d.S(e,"string"===typeof t.precedence?t.precedence:void 0,{crossOrigin:r,integrity:i,fetchPriority:o}):"script"===s&&n.d.X(e,{crossOrigin:r,integrity:i,fetchPriority:o,nonce:"string"===typeof t.nonce?t.nonce:void 0})}},t.preinitModule=function(e,t){if("string"===typeof e)if("object"===typeof t&&null!==t){if(null==t.as||"script"===t.as){var s=c(t.as,t.crossOrigin);n.d.M(e,{crossOrigin:s,integrity:"string"===typeof t.integrity?t.integrity:void 0,nonce:"string"===typeof t.nonce?t.nonce:void 0})}}else null==t&&n.d.M(e)},t.preload=function(e,t){if("string"===typeof e&&"object"===typeof t&&null!==t&&"string"===typeof t.as){var s=t.as,r=c(s,t.crossOrigin);n.d.L(e,s,{crossOrigin:r,integrity:"string"===typeof t.integrity?t.integrity:void 0,nonce:"string"===typeof t.nonce?t.nonce:void 0,type:"string"===typeof t.type?t.type:void 0,fetchPriority:"string"===typeof t.fetchPriority?t.fetchPriority:void 0,referrerPolicy:"string"===typeof t.referrerPolicy?t.referrerPolicy:void 0,imageSrcSet:"string"===typeof t.imageSrcSet?t.imageSrcSet:void 0,imageSizes:"string"===typeof t.imageSizes?t.imageSizes:void 0,media:"string"===typeof t.media?t.media:void 0})}},t.preloadModule=function(e,t){if("string"===typeof e)if(t){var s=c(t.as,t.crossOrigin);n.d.m(e,{as:"string"===typeof t.as&&"script"!==t.as?t.as:void 0,crossOrigin:s,integrity:"string"===typeof t.integrity?t.integrity:void 0})}else n.d.m(e)},t.requestFormReset=function(e){n.d.r(e)},t.unstable_batchedUpdates=function(e,t){return e(t)},t.useFormState=function(e,t,s){return a.H.useFormState(e,t,s)},t.useFormStatus=function(){return a.H.useHostTransitionStatus()},t.version="19.2.4"},950(e,t,s){!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=s(672)},799(e,t){var s=Symbol.for("react.transitional.element");function r(e,t,r){var i=null;if(void 0!==r&&(i=""+r),void 0!==t.key&&(i=""+t.key),"key"in t)for(var o in r={},t)"key"!==o&&(r[o]=t[o]);else r=t;return t=r.ref,{$$typeof:s,type:e,key:i,ref:void 0!==t?t:null,props:r}}Symbol.for("react.fragment"),t.jsx=r,t.jsxs=r},288(e,t){var s=Symbol.for("react.transitional.element"),r=Symbol.for("react.portal"),i=Symbol.for("react.fragment"),o=Symbol.for("react.strict_mode"),n=Symbol.for("react.profiler"),l=Symbol.for("react.consumer"),a=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),f=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),u=Symbol.for("react.lazy"),h=Symbol.for("react.activity"),p=Symbol.iterator;var y={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},m=Object.assign,x={};function v(e,t,s){this.props=e,this.context=t,this.refs=x,this.updater=s||y}function g(){}function S(e,t,s){this.props=e,this.context=t,this.refs=x,this.updater=s||y}v.prototype.isReactComponent={},v.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},v.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},g.prototype=v.prototype;var b=S.prototype=new g;b.constructor=S,m(b,v.prototype),b.isPureReactComponent=!0;var E=Array.isArray;function w(){}var R={H:null,A:null,T:null,S:null},T=Object.prototype.hasOwnProperty;function C(e,t,r){var i=r.ref;return{$$typeof:s,type:e,key:t,ref:void 0!==i?i:null,props:r}}function M(e){return"object"===typeof e&&null!==e&&e.$$typeof===s}var A=/\/+/g;function k(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(e){return t[e]})}(""+e.key):t.toString(36)}function O(e,t,i,o,n){var l=typeof e;"undefined"!==l&&"boolean"!==l||(e=null);var a,c,f=!1;if(null===e)f=!0;else switch(l){case"bigint":case"string":case"number":f=!0;break;case"object":switch(e.$$typeof){case s:case r:f=!0;break;case u:return O((f=e._init)(e._payload),t,i,o,n)}}if(f)return n=n(e),f=""===o?"."+k(e,0):o,E(n)?(i="",null!=f&&(i=f.replace(A,"$&/")+"/"),O(n,t,i,"",function(e){return e})):null!=n&&(M(n)&&(a=n,c=i+(null==n.key||e&&e.key===n.key?"":(""+n.key).replace(A,"$&/")+"/")+f,n=C(a.type,c,a.props)),t.push(n)),1;f=0;var d,h=""===o?".":o+":";if(E(e))for(var y=0;y<e.length;y++)f+=O(o=e[y],t,i,l=h+k(o,y),n);else if("function"===typeof(y=null===(d=e)||"object"!==typeof d?null:"function"===typeof(d=p&&d[p]||d["@@iterator"])?d:null))for(e=y.call(e),y=0;!(o=e.next()).done;)f+=O(o=o.value,t,i,l=h+k(o,y++),n);else if("object"===l){if("function"===typeof e.then)return O(function(e){switch(e.status){case"fulfilled":return e.value;case"rejected":throw e.reason;default:switch("string"===typeof e.status?e.then(w,w):(e.status="pending",e.then(function(t){"pending"===e.status&&(e.status="fulfilled",e.value=t)},function(t){"pending"===e.status&&(e.status="rejected",e.reason=t)})),e.status){case"fulfilled":return e.value;case"rejected":throw e.reason}}throw e}(e),t,i,o,n);throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.")}return f}function D(e,t,s){if(null==e)return e;var r=[],i=0;return O(e,r,"","",function(e){return t.call(s,e,i++)}),r}function j(e){if(-1===e._status){var t=e._result;(t=t()).then(function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)},function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)}),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var I="function"===typeof reportError?reportError:function(e){if("object"===typeof window&&"function"===typeof window.ErrorEvent){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:"object"===typeof e&&null!==e&&"string"===typeof e.message?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if("object"===typeof process&&"function"===typeof process.emit)return void process.emit("uncaughtException",e);console.error(e)},_={map:D,forEach:function(e,t,s){D(e,function(){t.apply(this,arguments)},s)},count:function(e){var t=0;return D(e,function(){t++}),t},toArray:function(e){return D(e,function(e){return e})||[]},only:function(e){if(!M(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};t.Activity=h,t.Children=_,t.Component=v,t.Fragment=i,t.Profiler=n,t.PureComponent=S,t.StrictMode=o,t.Suspense=f,t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=R,t.__COMPILER_RUNTIME={__proto__:null,c:function(e){return R.H.useMemoCache(e)}},t.cache=function(e){return function(){return e.apply(null,arguments)}},t.cacheSignal=function(){return null},t.cloneElement=function(e,t,s){if(null===e||void 0===e)throw Error("The argument must be a React element, but you passed "+e+".");var r=m({},e.props),i=e.key;if(null!=t)for(o in void 0!==t.key&&(i=""+t.key),t)!T.call(t,o)||"key"===o||"__self"===o||"__source"===o||"ref"===o&&void 0===t.ref||(r[o]=t[o]);var o=arguments.length-2;if(1===o)r.children=s;else if(1<o){for(var n=Array(o),l=0;l<o;l++)n[l]=arguments[l+2];r.children=n}return C(e.type,i,r)},t.createContext=function(e){return(e={$$typeof:a,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null}).Provider=e,e.Consumer={$$typeof:l,_context:e},e},t.createElement=function(e,t,s){var r,i={},o=null;if(null!=t)for(r in void 0!==t.key&&(o=""+t.key),t)T.call(t,r)&&"key"!==r&&"__self"!==r&&"__source"!==r&&(i[r]=t[r]);var n=arguments.length-2;if(1===n)i.children=s;else if(1<n){for(var l=Array(n),a=0;a<n;a++)l[a]=arguments[a+2];i.children=l}if(e&&e.defaultProps)for(r in n=e.defaultProps)void 0===i[r]&&(i[r]=n[r]);return C(e,o,i)},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=M,t.lazy=function(e){return{$$typeof:u,_payload:{_status:-1,_result:e},_init:j}},t.memo=function(e,t){return{$$typeof:d,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=R.T,s={};R.T=s;try{var r=e(),i=R.S;null!==i&&i(s,r),"object"===typeof r&&null!==r&&"function"===typeof r.then&&r.then(w,I)}catch(o){I(o)}finally{null!==t&&null!==s.types&&(t.types=s.types),R.T=t}},t.unstable_useCacheRefresh=function(){return R.H.useCacheRefresh()},t.use=function(e){return R.H.use(e)},t.useActionState=function(e,t,s){return R.H.useActionState(e,t,s)},t.useCallback=function(e,t){return R.H.useCallback(e,t)},t.useContext=function(e){return R.H.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e,t){return R.H.useDeferredValue(e,t)},t.useEffect=function(e,t){return R.H.useEffect(e,t)},t.useEffectEvent=function(e){return R.H.useEffectEvent(e)},t.useId=function(){return R.H.useId()},t.useImperativeHandle=function(e,t,s){return R.H.useImperativeHandle(e,t,s)},t.useInsertionEffect=function(e,t){return R.H.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return R.H.useLayoutEffect(e,t)},t.useMemo=function(e,t){return R.H.useMemo(e,t)},t.useOptimistic=function(e,t){return R.H.useOptimistic(e,t)},t.useReducer=function(e,t,s){return R.H.useReducer(e,t,s)},t.useRef=function(e){return R.H.useRef(e)},t.useState=function(e){return R.H.useState(e)},t.useSyncExternalStore=function(e,t,s){return R.H.useSyncExternalStore(e,t,s)},t.useTransition=function(){return R.H.useTransition()},t.version="19.2.4"},43(e,t,s){e.exports=s(288)},579(e,t,s){e.exports=s(799)}},t={};function s(r){var i=t[r];if(void 0!==i)return i.exports;var o=t[r]={exports:{}};return e[r](o,o.exports,s),o.exports}var r=s(43),i=s(950);function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}function n(e){var t=function(e,t){if("object"!=o(e)||!e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var r=s.call(e,t||"default");if("object"!=o(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==o(t)?t:t+""}function l(e,t,s){return(t=n(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}function a(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),s.push.apply(s,r)}return s}function c(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?a(Object(s),!0).forEach(function(t){l(e,t,s[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):a(Object(s)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))})}return e}var f=s(579);const d=800,u=500,h=440,p=430,y="#0a0a2e",m="#2d0a3e",x="#00ffff",v="#ff00ff",g="#ff3333",S="#ff6600",b="#ffaa00",E="#00ffcc",w="#00ff66",R="#33ff33",T="#ff3399",C="#ffdd00",M="#ffffff",A="#ff88ff",k="#88aaff",O="#ff6622",D="#ff4444",j=[120,400,680],I=[195,265,335,465,535,605],_=[{icbm:8,mirv:0,fast:0,decoy:0,emp:0,nuke:0,bombers:0,stealth:0,cargo:0,drones:0,speed:.6},{icbm:10,mirv:0,fast:0,decoy:0,emp:0,nuke:0,bombers:1,stealth:0,cargo:0,drones:0,speed:.7},{icbm:10,mirv:2,fast:0,decoy:0,emp:0,nuke:0,bombers:1,stealth:0,cargo:0,drones:0,speed:.8},{icbm:12,mirv:2,fast:0,decoy:0,emp:0,nuke:0,bombers:1,stealth:0,cargo:1,drones:0,speed:.85},{icbm:10,mirv:2,fast:4,decoy:0,emp:0,nuke:0,bombers:1,stealth:0,cargo:1,drones:0,speed:.95},{icbm:12,mirv:3,fast:4,decoy:0,emp:0,nuke:0,bombers:2,stealth:1,cargo:1,drones:0,speed:1},{icbm:12,mirv:3,fast:4,decoy:3,emp:0,nuke:0,bombers:2,stealth:1,cargo:1,drones:0,speed:1.1},{icbm:14,mirv:4,fast:5,decoy:3,emp:0,nuke:0,bombers:2,stealth:2,cargo:1,drones:0,speed:1.15},{icbm:14,mirv:4,fast:5,decoy:3,emp:2,nuke:0,bombers:2,stealth:2,cargo:1,drones:1,speed:1.2},{icbm:15,mirv:5,fast:6,decoy:4,emp:2,nuke:0,bombers:3,stealth:2,cargo:1,drones:1,speed:1.3},{icbm:16,mirv:5,fast:6,decoy:4,emp:3,nuke:0,bombers:3,stealth:3,cargo:1,drones:2,speed:1.35},{icbm:16,mirv:6,fast:7,decoy:4,emp:3,nuke:2,bombers:3,stealth:3,cargo:1,drones:2,speed:1.4}];function L(e){const t=Math.min(e-1,_.length-1),s=c({},_[t]);if(e>12){const t=e-12;s.icbm+=2*t,s.mirv+=t,s.fast+=t,s.nuke+=t,s.speed=Math.min(2.5,s.speed+.1*t)}return s}class P{constructor(e,t,s,r,i,o){let n=arguments.length>6&&void 0!==arguments[6]?arguments[6]:2;this.x=e,this.y=t,this.vx=s,this.vy=r,this.color=i,this.life=o,this.maxLife=o,this.size=n,this.dead=!1}update(){this.x+=this.vx,this.y+=this.vy,this.vy+=.05,this.life--,this.life<=0&&(this.dead=!0)}draw(e){const t=this.life/this.maxLife;e.save(),e.globalAlpha=t,e.fillStyle=this.color,e.shadowBlur=4,e.shadowColor=this.color,e.fillRect(this.x-this.size/2,this.y-this.size/2,this.size,this.size),e.restore()}}class N{constructor(e,t,s){this.x=e,this.y=t,this.color=s,this.life=30,this.maxLife=30,this.dead=!1}update(){this.life--,this.life<=0&&(this.dead=!0)}draw(e){const t=this.life/this.maxLife*.6;e.save(),e.globalAlpha=t,e.fillStyle=this.color,e.shadowBlur=6,e.shadowColor=this.color,e.fillRect(this.x-1,this.y-1,3,3),e.restore()}}class B{constructor(e,t,s,r,i){let o=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];this.x=e,this.y=t,this.r=4,this.maxR=s,this.color1=r,this.color2=i,this.isPlayer=o,this.phase="grow",this.holdTimer=18,this.dead=!1,this.particles=[];const n=Math.floor(s/4);for(let l=0;l<n;l++){const s=Math.random()*Math.PI*2,o=1+3*Math.random();this.particles.push(new P(e,t,Math.cos(s)*o,Math.sin(s)*o,Math.random()>.5?r:i,20+20*Math.random(),2+3*Math.random()))}}get active(){return!this.dead}update(){this.particles.forEach(e=>e.update()),this.particles=this.particles.filter(e=>!e.dead),"grow"===this.phase?(this.r+=3,this.r>=this.maxR&&(this.r=this.maxR,this.phase="hold")):"hold"===this.phase?(this.holdTimer--,this.holdTimer<=0&&(this.phase="shrink")):(this.r-=2,this.r<=0&&(this.dead=!0))}draw(e){if(this.dead)return;this.particles.forEach(t=>t.draw(e));const t=e.createRadialGradient(this.x,this.y,0,this.x,this.y,this.r);t.addColorStop(0,this.color2+"ff"),t.addColorStop(.4,this.color1+"cc"),t.addColorStop(1,this.color1+"00"),e.save(),e.globalAlpha="hold"===this.phase?.85:.7,e.shadowBlur=20,e.shadowColor=this.color1,e.beginPath(),e.arc(this.x,this.y,this.r,0,2*Math.PI),e.fillStyle=t,e.fill(),e.restore()}contains(e,t){if(this.dead)return!1;const s=e-this.x,r=t-this.y;return Math.sqrt(s*s+r*r)<=this.r}}class H{constructor(e,t,s,r,i,o){this.x=e,this.y=t,this.tx=s,this.ty=r;const n=s-e,l=r-t,a=Math.sqrt(n*n+l*l);this.vx=n/a*i,this.vy=l/a*i,this.dead=!1,this.trails=[],this.gs=o}update(){this.trails.push(new N(this.x,this.y,x)),this.x+=this.vx,this.y+=this.vy,this.trails.forEach(e=>e.update()),this.trails=this.trails.filter(e=>!e.dead);const e=this.tx-this.x,t=this.ty-this.y;Math.sqrt(e*e+t*t)<6&&(this.dead=!0)}draw(e){this.trails.forEach(t=>t.draw(e)),e.save(),e.shadowBlur=12,e.shadowColor=x,e.fillStyle=x,e.fillRect(this.x-2,this.y-2,5,5),e.restore()}}class U{constructor(e,t,s,r){this.x=e,this.y=-10,this.tx=t.tx,this.ty=t.ty,this.type=s,this.speedMult=r,this.dead=!1,this.trails=[],this.hasExploded=!1;let i=.7;"fast"===s&&(i=1.4),"nuke"===s&&(i=.35),"emp"===s&&(i=.6),this.speed=i*r;const o=this.tx-e,n=this.ty-this.y,l=Math.sqrt(o*o+n*n);this.vx=o/l*this.speed,this.vy=n/l*this.speed,this.mirvSplit=!1,this.mirvY=150+100*Math.random(),this.flickerTimer=0,this.visible=!0}get trailColor(){return"emp"===this.type?k:"nuke"===this.type?A:"fast"===this.type?S:g}get explosionRadius(){return"nuke"===this.type?90:"emp"===this.type?60:30}update(){this.flickerTimer++,"decoy"===this.type&&(this.visible=Math.floor(this.flickerTimer/4)%2===0),this.trails.push(new N(this.x,this.y,this.trailColor)),this.x+=this.vx,this.y+=this.vy,this.trails.forEach(e=>e.update()),this.trails=this.trails.filter(e=>!e.dead);const e=this.tx-this.x,t=this.ty-this.y;Math.sqrt(e*e+t*t)<8&&(this.dead=!0,this.hasExploded=!0)}draw(e){if(!this.visible)return;this.trails.forEach(t=>t.draw(e)),e.save(),e.shadowBlur="nuke"===this.type?20:10,e.shadowColor=this.trailColor,e.fillStyle=this.trailColor;const t="nuke"===this.type?7:"fast"===this.type?2:4;e.fillRect(this.x-t/2,this.y-t/2,t,t),e.restore()}}class Y{constructor(e,t){this.type=e,this.fromLeft=Math.random()>.5,this.x=this.fromLeft?-40:840,this.y=60+100*Math.random(),this.speed=("drone"===this.type?2:1.2)*(.8+.3*t),this.fromLeft||(this.speed=-this.speed),this.dead=!1,this.hp="drone"===e?1:2,this.dropTimer=120+180*Math.random(),this.flickerTimer=0,this.visible=!0,this.droppedAmmo=!1}get color(){return"stealth"===this.type?O:"cargo"===this.type?"#aaffaa":"drone"===this.type?D:"#ff8888"}update(){this.flickerTimer++,"stealth"===this.type&&(this.visible=Math.floor(this.flickerTimer/6)%3!==0),this.x+=this.speed,this.dropTimer--,(this.x<-60||this.x>860)&&(this.dead=!0)}draw(e){if(!this.visible)return;e.save(),e.shadowBlur=12,e.shadowColor=this.color,e.fillStyle=this.color;const t=this.speed<0?-1:1;e.save(),e.translate(this.x,this.y),e.scale(t,1),"drone"===this.type?(e.fillRect(-6,-3,12,6),e.fillRect(-3,-6,6,3)):(e.fillRect(-16,-4,32,8),e.fillRect(-8,-4,16,-6),e.fillRect(-8,4,16,6),e.fillRect(-16,-6,6,12),"cargo"===this.type&&(e.fillStyle="#88ff88",e.fillRect(-4,-3,8,6))),e.restore(),e.restore()}}class z{constructor(e,t){this.fromLeft=e,this.x=e?-30:830,this.y=432,this.speed=e?t:-t,this.dead=!1,this.destroyed=!1,this.flashTimer=0,this.armor=!1,this.hp=1}update(){this.flashTimer++,this.x+=this.speed,this.fromLeft&&this.x>830&&(this.dead=!0),!this.fromLeft&&this.x<-30&&(this.dead=!0)}draw(e){this.destroyed||(e.save(),e.shadowBlur=10,e.shadowColor=C,e.fillStyle=C,e.fillRect(this.x-14,this.y-8,28,12),e.fillStyle="#cc8800",e.fillRect(this.x-14,this.y-12,10,8),e.fillStyle="#333",e.fillRect(this.x-12,this.y+4,6,6),e.fillRect(this.x+6,this.y+4,6,6),Math.floor(this.flashTimer/15)%2===0&&(e.fillStyle="#ff4444",e.shadowBlur=8,e.shadowColor="#ff4444",e.fillRect(this.x-2,this.y-14,4,4)),e.restore())}}function W(){return{scene:"title",wave:1,score:0,researchCredits:0,bases:j.map(e=>({x:e,ammo:10,alive:!0,disabled:!1,disableTimer:0,hasArmor:!1,armored:!1,autoTurret:!1,autoTurretTimer:0})),cities:I.map(e=>({x:e,alive:!0,shielded:!1,isDecoy:!1})),upgrades:{blastRadius:0,missileSpeed:0,chainReaction:!1,dualWarhead:!1,autoTurret:!1,cityShield:0,baseArmor:!1,empHardening:!1,decoyCity:!1,extraAmmo:0,truckArmor:!1,fastTrucks:!1,truckCapacity:0},waveStats:{enemiesDestroyed:0,citiesSaved:0,ammoRemaining:0},shake:{x:0,y:0,timer:0}}}function F(e,t,s,r,i,o){let n=!(arguments.length>6&&void 0!==arguments[6])||arguments[6];e.save(),e.font="bold ".concat(i,"px monospace"),e.textAlign="center",e.textBaseline="middle",n&&(e.shadowBlur=16,e.shadowColor=o),e.fillStyle=o,e.fillText(t,s,r),e.restore()}function K(e,t,s){if(!t.alive)return e.save(),e.globalAlpha=.5,e.fillStyle="#441144",e.fillRect(t.x-14,432,28,8),void e.restore();const r=t.x,i=.7+.3*Math.sin(.04*s+.01*t.x);e.save(),e.shadowBlur=12*i,e.shadowColor=t.isDecoy?"#888800":E,[{ox:-14,w:8,h:20},{ox:-5,w:10,h:28},{ox:6,w:8,h:22},{ox:14,w:7,h:16}].forEach(s=>{e.fillStyle=t.isDecoy?"#888800":E,e.globalAlpha=t.isDecoy?.5+.3*i:1,e.fillRect(r+s.ox,h-s.h,s.w,s.h),e.fillStyle="#ffffff",e.globalAlpha=.3+.3*i;for(let t=h-s.h+3;t<437;t+=6)for(let i=r+s.ox+1;i<r+s.ox+s.w-1;i+=4)Math.random()>.3&&e.fillRect(i,t,2,3)}),t.shielded&&(e.globalAlpha=.3+.15*Math.sin(.08*s),e.strokeStyle="#00aaff",e.lineWidth=2,e.shadowBlur=20,e.shadowColor="#00aaff",e.beginPath(),e.arc(r,426,24,Math.PI,0),e.stroke()),e.restore()}function G(e,t,s){const{x:r,ammo:i,alive:o,disabled:n}=t;if(!o){e.save(),e.globalAlpha=.6,e.fillStyle="#552200",e.fillRect(r-18,430,36,10),e.globalAlpha=.4+.3*Math.random(),e.fillStyle="#ff6600";for(let t=0;t<3;t++)e.fillRect(r-15+30*Math.random(),430+8*Math.random(),2,2);return void e.restore()}const l=n?.3+.2*Math.sin(.3*s):.7+.3*Math.sin(.05*s+.01*r);e.save(),e.shadowBlur=14*l,e.shadowColor=n?"#4466ff":w,e.fillStyle=n?"#334488":w,e.fillRect(r-18,432,36,8),e.fillRect(r-6,422,12,12),e.fillRect(r-2,414,4,10),n&&(e.fillStyle="#aaaaff",e.font="bold 9px monospace",e.textAlign="center",e.fillText("EMP",r,408)),e.fillStyle=i>3?w:"#ff4444";for(let a=0;a<i;a++)e.fillRect(r-18+4*a,442,3,5);e.restore()}function $(e,t,s,r){if(e.save(),"briggs"===t)e.fillStyle="#d4a574",e.fillRect(s,r,40,44),e.fillStyle="#8B6914",e.fillRect(s+4,r+12,14,8),e.fillRect(s+22,r+12,14,8),e.fillStyle="#FFD700",e.fillRect(s+18,r+15,4,2),e.fillStyle="#2d4a1e",e.fillRect(s-2,r-10,44,12),e.fillRect(s+4,r-4,32,4),e.fillStyle="#8B4513",e.fillRect(s+10,r+28,20,3),e.fillStyle="#FFD700",e.fillRect(s+2,r+38,5,5),e.fillRect(s+33,r+38,5,5);else if("pixel"===t)e.fillStyle="#f0c090",e.fillRect(s+4,r+8,32,36),e.fillStyle="#cc44cc",e.fillRect(s,r,40,16),e.fillRect(s-4,r+4,8,24),e.fillRect(s+36,r+4,8,24),e.fillRect(s+2,r-4,36,12),e.fillStyle="#88aaff",e.fillRect(s+6,r+16,10,8),e.fillRect(s+24,r+16,10,8),e.strokeStyle="#ffffff",e.lineWidth=1,e.strokeRect(s+6,r+16,10,8),e.strokeRect(s+24,r+16,10,8),e.fillStyle="#333",e.fillRect(s+16,r+19,8,2),e.fillStyle="#cc6666",e.fillRect(s+10,r+32,20,4),e.fillStyle="#ddddff",e.fillRect(s+2,r+44,36,8);else if("comandante"===t){const t=Math.random()>.7;e.fillStyle=t?"#ff0000":"#220033",e.fillRect(s,r,40,48),e.strokeStyle="#ff00ff",e.lineWidth=1,e.strokeRect(s+4,r+4,32,40),e.beginPath(),e.moveTo(s+4,r+24),e.lineTo(s+36,r+24),e.moveTo(s+20,r+4),e.lineTo(s+20,r+44),e.stroke(),e.fillStyle=t?"#ff4400":"#ff00ff",e.shadowBlur=20,e.shadowColor="#ff00ff",e.fillRect(s+6,r+12,10,8),e.fillRect(s+24,r+12,10,8),t&&(e.fillStyle="#ff000088",e.fillRect(s+20*Math.random(),r+20*Math.random(),40,3)),e.fillStyle="#00ffff",e.font="bold 8px monospace",e.textAlign="center",e.fillText("AI",s+20,r+36)}e.strokeStyle="#ff00ff",e.lineWidth=2,e.strokeRect(s-2,r-2,44,52),e.restore()}function V(){const e=(0,r.useRef)(null),t=(0,r.useRef)(W()),[s,i]=(0,r.useState)("title"),[o,n]=(0,r.useState)({}),l=(0,r.useRef)(null),a=(0,r.useRef)(0),c=(0,r.useRef)({playerMissiles:[],enemyMissiles:[],explosions:[],aircraft:[],trucks:[],alerts:[],pendingEnemies:[],waveActive:!1,waveEndTimer:0,spawnTimer:0,storyScrollY:0,storyDone:!1,cutsceneStep:0,crosshair:{x:400,y:250},truckSpawnPending:!1,trucksDone:!1,waveEndScore:null,ammoDrops:[]}),g=(0,r.useCallback)(()=>{const e=t.current,s=c.current,r=L(e.wave),i=[],o=[...e.cities.filter(e=>e.alive).map(e=>({tx:e.x,ty:430})),...e.bases.filter(e=>e.alive).map(e=>({tx:e.x,ty:p}))],n=()=>o.length?o[Math.floor(Math.random()*o.length)]:{tx:Math.random()*d,ty:h},l=(e,t)=>{for(let s=0;s<t;s++){const t=n();i.push({type:e,t:t,delay:60+400*Math.random()})}};l("icbm",r.icbm),l("mirv",r.mirv),l("fast",r.fast),l("decoy",r.decoy),l("emp",r.emp),l("nuke",r.nuke),i.sort((e,t)=>e.delay-t.delay),s.pendingEnemies=i.map(e=>({delay:e.delay,missile:new U(50+700*Math.random(),e.t,e.type,r.speed)})),s.enemyMissiles=[],s.playerMissiles=[],s.explosions=[],s.aircraft=[],s.alerts=[],s.spawnTimer=0,s.waveActive=!0,s.waveEndTimer=0,s.trucksDone=!1,s.truckSpawnPending=!1,s.waveEndScore=null,s.ammoDrops=[],e.waveStats={enemiesDestroyed:0,citiesSaved:0,ammoRemaining:0};const a=r;for(let t=0;t<a.bombers;t++)setTimeout(()=>{s.waveActive&&s.aircraft.push(new Y("bomber",r.speed))},2e3+3e3*t);for(let t=0;t<a.stealth;t++)setTimeout(()=>{s.waveActive&&s.aircraft.push(new Y("stealth",r.speed))},5e3+4e3*t);for(let t=0;t<a.cargo;t++)setTimeout(()=>{s.waveActive&&s.aircraft.push(new Y("cargo",r.speed))},3e3+5e3*t);a.drones>0&&setTimeout(()=>{if(s.waveActive)for(let e=0;e<4*a.drones;e++){const t=new Y("drone",r.speed);t.y+=12*e-24,s.aircraft.push(t)}},7e3)},[]),S=(0,r.useCallback)((e,s)=>{const r=t.current,i=c.current;if("playing"!==r.scene)return;let o=null,n=1/0;if(r.bases.forEach(t=>{if(!t.alive||t.ammo<=0||t.disabled)return;const s=Math.abs(t.x-e);s<n&&(n=s,o=t)}),!o)return;o.ammo--;const l=5+1.5*r.upgrades.missileSpeed;i.playerMissiles.push(new H(o.x,410,e,s,l,r))},[]),w=(0,r.useCallback)(t=>{const s=e.current;if(!s)return;const r=s.getBoundingClientRect(),i=d/r.width,o=u/r.height,n=(t.clientX-r.left)*i,l=(t.clientY-r.top)*o;S(n,l)},[S]),A=(0,r.useCallback)(t=>{const s=e.current;if(!s)return;const r=s.getBoundingClientRect(),i=d/r.width,o=u/r.height;c.current.crosshair={x:(t.clientX-r.left)*i,y:(t.clientY-r.top)*o}},[]),k=(0,r.useRef)(null);(0,r.useEffect)(()=>{const s=e.current;if(!s)return;const r=s.getContext("2d");r.imageSmoothingEnabled=!1;const o=Array.from({length:120},()=>({x:Math.random()*d,y:400*Math.random(),alpha:.3+.7*Math.random(),size:Math.random()>.8?2:1,phase:100*Math.random()}));let f=!0;return l.current=requestAnimationFrame(function e(){if(!f)return;const s=++a.current,g=t.current,S=c.current;if(k.current){const{newScene:e,data:t}=k.current;k.current=null,g.scene=e,i(e),t&&n(t)}let w=0,A=0;g.shake.timer>0&&(w=(Math.random()-.5)*g.shake.timer*1.5,A=(Math.random()-.5)*g.shake.timer*1.5,g.shake.timer--),r.save(),r.translate(w,A),r.fillStyle=y,r.fillRect(0,0,d,u),function(e,t,s){e.save(),t.forEach(t=>{const r=.4+.6*Math.abs(Math.sin(.03*(s+t.phase)));e.globalAlpha=r*t.alpha,e.fillStyle=M,e.fillRect(t.x,t.y,t.size,t.size)}),e.restore()}(r,o,s),function(e){e.save(),e.globalAlpha=.08,e.strokeStyle="#ff00ff",e.lineWidth=.5;const t={ox:400,oy:h};for(let s=0;s<=20;s++){const r=s/20*d;e.beginPath(),e.moveTo(r,h),e.lineTo(t.ox,500),e.stroke()}for(let s=1;s<=8;s++){const t=s/8,r=h+60*t,i=400-400*t,o=400+400*t;e.beginPath(),e.moveTo(i,r),e.lineTo(o,r),e.stroke()}e.restore()}(r),function(e){e.save(),e.fillStyle=m,e.shadowBlur=0,e.fillRect(0,h,d,60),e.strokeStyle="#ff00ff",e.lineWidth=1,e.shadowBlur=8,e.shadowColor="#ff00ff",e.beginPath(),e.moveTo(0,h),e.lineTo(d,h),e.stroke(),e.restore()}(r),"title"===g.scene?function(e,t){t%80===0&&c.current.enemyMissiles.push(new U(100+600*Math.random(),{tx:100+600*Math.random(),ty:430},"icbm",.5));c.current.enemyMissiles.forEach(t=>{t.update(),t.draw(e)}),c.current.enemyMissiles=c.current.enemyMissiles.filter(e=>!e.dead),c.current.enemyMissiles.forEach(e=>{e.hasExploded&&c.current.explosions.push(new B(e.tx,e.ty,30,b,"#ff6600",!1))}),c.current.explosions.forEach(t=>{t.update(),t.draw(e)}),c.current.explosions=c.current.explosions.filter(e=>!e.dead);const s=12+8*Math.sin(.05*t);e.save(),e.shadowBlur=s,e.shadowColor=T,e.fillStyle=T,e.font="bold 36px monospace",e.textAlign="center",e.textBaseline="middle",e.fillText("MISSILE COMMAND",400,160),e.shadowColor="#ff6600",e.shadowBlur=.8*s,e.fillStyle="#ff6600",e.font="bold 28px monospace",e.fillText("NEON APOCALYPSE",400,200),e.shadowBlur=8,e.shadowColor=R,e.fillStyle=R,e.font="13px monospace",e.fillText("Defend the Grid. Save the Future. Look Cool Doing It.",400,235),e.restore()}(r,s):"story"===g.scene?(!function(e,t){const s=["","THE YEAR IS 1987. BUT NOT YOUR 1987.","","IN THIS TIMELINE, THE COLD WAR WENT HOT \u2014 IN NEON.","",'A ROGUE AI CODENAMED "COMANDANTE" HAS SEIZED CONTROL',"OF THE ENEMY'S NUCLEAR ARSENAL.","","ONLY YOU \u2014 COMMANDER OF THE LAST DEFENSE GRID \u2014","CAN STOP THE NEON APOCALYPSE.","","YOUR CITIES. YOUR MISSILES. YOUR CALL.","","GOOD LUCK, COMMANDER.","YOU'LL NEED IT.","","","[ CLICK TO SKIP ]"],r=250-t.storyScrollY+u;e.save(),e.shadowBlur=10,e.shadowColor=R,e.fillStyle=R,e.font="14px monospace",e.textAlign="center",s.forEach((t,s)=>{const i=r+26*s;i>0&&i<u&&e.fillText(t,400,i)}),e.restore(),r+26*s.length<0&&(t.storyDone=!0)}(r,S),S.storyScrollY+=.6,(S.storyScrollY>700||S.storyDone)&&(S.storyDone||(S.storyDone=!0,setTimeout(()=>{k.current={newScene:"playing"}},1500)))):"playing"===g.scene?function(e,t,s,r){s.alerts=s.alerts.filter(e=>(e.timer--,e.timer>0)),s.spawnTimer++;for(;s.pendingEnemies.length>0&&s.spawnTimer>=s.pendingEnemies[0].delay;)s.enemyMissiles.push(s.pendingEnemies.shift().missile);t.bases.forEach(e=>{if(e.alive&&e.autoTurret&&!e.disabled&&!(e.ammo<=0)&&(e.autoTurretTimer=(e.autoTurretTimer||0)+1,e.autoTurretTimer>=240)){e.autoTurretTimer=0;let r=null,i=1/0;if(s.enemyMissiles.forEach(t=>{const s=Math.hypot(t.x-e.x,t.y-p);s<i&&(i=s,r=t)}),r){e.ammo--;const i=5+1.5*t.upgrades.missileSpeed;s.playerMissiles.push(new H(e.x,410,r.x,r.y,i,t))}}}),s.playerMissiles.forEach(e=>e.update());const i=s.playerMissiles.filter(e=>e.dead);s.playerMissiles=s.playerMissiles.filter(e=>!e.dead),i.forEach(e=>{const r=30+7*t.upgrades.blastRadius;s.explosions.push(new B(e.tx,e.ty,r,v,"#ffffff",!0)),t.upgrades.dualWarhead&&setTimeout(()=>{s.explosions.push(new B(e.tx,e.ty,1.5*r,v,"#ffffff",!0))},300)}),s.enemyMissiles.forEach(e=>{if(e.update(),"mirv"===e.type&&!e.mirvSplit&&e.y>=e.mirvY){e.mirvSplit=!0,s.alerts.push({text:"\u26a0 MIRV SPLIT!",timer:90});for(let r=0;r<2+Math.floor(2*Math.random());r++){const r=L(t.wave),i=e.tx+200*(Math.random()-.5),o={tx:Math.max(10,Math.min(790,i)),ty:430};s.enemyMissiles.push(new U(e.x,o,"icbm",1.2*r.speed))}}});const o=[];s.enemyMissiles.forEach(e=>{if(!e.hasExploded)return;if(o.push(e),"decoy"===e.type)return;const r=e.explosionRadius,i="emp"===e.type?"#88aaff":"nuke"===e.type?"#ffccff":b;s.explosions.push(new B(e.tx,e.ty,r,i,b,!1)),t.shake.timer=Math.max(t.shake.timer,"nuke"===e.type?12:5),t.cities.forEach(t=>{if(t.alive&&Math.abs(t.x-e.tx)<r&&Math.abs(h-e.ty)<r){if(t.isDecoy)return void(t.alive=!1);if(t.shielded)return void(t.shielded=!1);t.alive=!1,s.alerts.push({text:"!! CITY DESTROYED !!",timer:120})}}),t.bases.forEach(i=>{i.alive&&Math.abs(i.x-e.tx)<r&&Math.abs(p-e.ty)<r&&("emp"===e.type?(i.disabled=!0,i.disableTimer=t.upgrades.empHardening?180:600,s.alerts.push({text:"\u26a1 BASE EMP'D!",timer:120})):i.hasArmor&&!i.armored?i.armored=!0:(i.alive=!1,s.alerts.push({text:"!! BASE DESTROYED !!",timer:120})))})}),s.enemyMissiles=s.enemyMissiles.filter(e=>!e.hasExploded),s.explosions.forEach(e=>{e.isPlayer&&(s.enemyMissiles.forEach(r=>{if(!r.dead&&e.contains(r.x,r.y)&&(r.dead=!0,r.hasExploded=!1,t.score+="nuke"===r.type?500:"mirv"===r.type?200:"fast"===r.type?150:100,t.researchCredits+="nuke"===r.type?50:10,t.waveStats.enemiesDestroyed++,t.upgrades.chainReaction&&Math.random()<.25)){const e=20+5*t.upgrades.blastRadius;s.explosions.push(new B(r.x,r.y,e,v,"#ffffff",!0))}}),s.aircraft.forEach(r=>{if(!r.dead&&e.contains(r.x,r.y)&&(r.hp--,r.hp<=0)){r.dead=!0;const e="stealth"===r.type?250:"cargo"===r.type?50:"drone"===r.type?75:100;t.score+=e,t.researchCredits+=15,t.waveStats.enemiesDestroyed++,"cargo"!==r.type||r.droppedAmmo||(r.droppedAmmo=!0,s.ammoDrops.push({x:r.x,y:r.y,life:300}))}}))}),s.enemyMissiles=s.enemyMissiles.filter(e=>!e.dead),s.aircraft.forEach(e=>{if(e.update(),("bomber"===e.type||"stealth"===e.type)&&e.dropTimer<=0){e.dropTimer=120+120*Math.random();const r=L(t.wave),i={tx:50+700*Math.random(),ty:430},o="stealth"===e.type?"fast":"icbm";s.enemyMissiles.push(new U(e.x,i,o,r.speed))}}),s.aircraft=s.aircraft.filter(e=>!e.dead),s.ammoDrops.forEach(e=>{e.life--,e.y+=1.5,t.bases.forEach(t=>{t.alive&&Math.abs(t.x-e.x)<20&&Math.abs(p-e.y)<30&&(t.ammo=Math.min(t.ammo+5,20),e.life=0)})}),s.ammoDrops=s.ammoDrops.filter(e=>e.life>0),t.bases.forEach(e=>{e.disabled&&(e.disableTimer--,e.disableTimer<=0&&(e.disabled=!1))}),s.trucks.forEach(e=>{e.update(),t.bases.forEach(s=>{if(s.alive&&Math.abs(e.x-s.x)<5&&!e.destroyed){const e=3+2*t.upgrades.truckCapacity;s.ammo=Math.min(s.ammo+e,20)}}),s.explosions.forEach(r=>{r.isPlayer||!e.destroyed&&r.contains(e.x,e.y)&&(t.upgrades.truckArmor&&e.hp>1?e.hp--:(e.destroyed=!0,s.explosions.push(new B(e.x,e.y,25,"#ffcc00","#ff6600",!1))))})}),s.trucks=s.trucks.filter(e=>!e.dead),s.explosions.forEach(e=>e.update()),s.explosions=s.explosions.filter(e=>!e.dead),t.cities.forEach(t=>K(e,t,r)),t.bases.forEach(t=>G(e,t,r)),s.trucks.forEach(t=>t.draw(e)),s.ammoDrops.forEach(t=>{e.save(),e.fillStyle=C,e.shadowBlur=10,e.shadowColor=C,e.fillRect(t.x-5,t.y-5,10,10),e.fillStyle="#ffffff",e.font="8px monospace",e.textAlign="center",e.fillText("+",t.x,t.y+3),e.restore()}),s.aircraft.forEach(t=>t.draw(e)),s.enemyMissiles.forEach(t=>t.draw(e)),s.playerMissiles.forEach(t=>t.draw(e)),s.explosions.forEach(t=>t.draw(e));const n=s.crosshair;e.save(),e.strokeStyle=x,e.lineWidth=1,e.globalAlpha=.7,e.shadowBlur=8,e.shadowColor=x,e.beginPath(),e.moveTo(n.x-10,n.y),e.lineTo(n.x+10,n.y),e.stroke(),e.beginPath(),e.moveTo(n.x,n.y-10),e.lineTo(n.x,n.y+10),e.stroke(),e.beginPath(),e.arc(n.x,n.y,5,0,2*Math.PI),e.stroke(),e.restore(),s.alerts.length>0&&function(e,t,s){const r=.6+.4*Math.sin(.15*s);e.save(),e.globalAlpha=r,e.font="bold 16px monospace",e.textAlign="center",e.textBaseline="middle",e.shadowBlur=20,e.shadowColor=T,e.fillStyle=T,e.fillText(t,400,55),e.restore()}(e,s.alerts[s.alerts.length-1].text,r);!function(e,t){e.save(),e.fillStyle="rgba(0,0,0,0.5)",e.fillRect(0,0,d,36),F(e,"WAVE: ".concat(t.wave),80,18,14,R),F(e,"SCORE: ".concat(t.score),260,18,14,R),F(e,"CREDITS: ".concat(t.researchCredits),460,18,14,T);let s=780;for(let i=5;i>=0;i--){var r;const o=null===(r=t.cities[i])||void 0===r?void 0:r.alive;e.shadowBlur=o?8:0,e.shadowColor=E,e.fillStyle=o?E:"#333333",e.fillRect(s-8,8,10,18),s-=16}e.restore()}(e,t);const l=0===s.pendingEnemies.length&&0===s.enemyMissiles.length&&0===s.aircraft.length,a=t.cities.every(e=>!e.alive);if(a)return s.waveActive=!1,void(k.current={newScene:"gameover"});if(l&&s.waveActive){s.waveActive=!1;const e=t.bases.reduce((e,t)=>e+(t.alive?t.ammo:0),0),r=t.cities.filter(e=>e.alive).length,i=50*e+200*r;t.score+=i,t.researchCredits+=25*r+Math.floor(5*t.waveStats.enemiesDestroyed),t.waveStats.ammoRemaining=e,t.waveStats.citiesSaved=r,s.waveEndScore={bonusScore:i,ammoLeft:e,citiesSaved:r};const o=t.upgrades.fastTrucks?2.5:1.5;s.trucks.push(new z(!0,o)),t.upgrades.truckArmor&&(s.trucks[s.trucks.length-1].hp=2),k.current={newScene:"wave_end"}}}(r,g,S,s):"wave_end"===g.scene?function(e,t,s,r){t.cities.forEach(t=>K(e,t,r)),t.bases.forEach(t=>G(e,t,r)),s.trucks.forEach(t=>{t.update(),t.draw(e)}),s.explosions.forEach(t=>{t.update(),t.draw(e)}),s.explosions=s.explosions.filter(e=>!e.dead),e.save(),e.fillStyle="rgba(0,0,0,0.65)",e.fillRect(180,80,440,280),e.strokeStyle=R,e.lineWidth=2,e.shadowBlur=12,e.shadowColor=R,e.strokeRect(180,80,440,280),e.restore(),F(e,"WAVE ".concat(t.wave," COMPLETE"),400,120,20,R);const i=s.waveEndScore||{};F(e,"CITIES SAVED: ".concat(i.citiesSaved||0),400,160,14,E),F(e,"AMMO REMAINING: ".concat(i.ammoLeft||0),400,185,14,R),F(e,"ENEMIES DESTROYED: ".concat(t.waveStats.enemiesDestroyed),400,210,14,R),F(e,"BONUS SCORE: +".concat(i.bonusScore||0),400,235,14,T),F(e,"TOTAL SCORE: ".concat(t.score),400,260,16,R);const o=Math.floor(r/30)%2===0;o&&F(e,"[CLICK FOR UPGRADES]",400,330,13,T)}(r,g,S,s):"cutscene"===g.scene?function(e,t,s,r){e.save(),e.fillStyle="rgba(0,0,0,0.8)",e.fillRect(0,0,d,u);const i=s.cutsceneData;if(!i)return void e.restore();e.strokeStyle=T,e.lineWidth=2,e.shadowBlur=12,e.shadowColor=T,e.strokeRect(60,140,200,220),e.fillStyle="#110022",e.fillRect(61,141,198,218),$(e,i.character,80,160),F(e,i.name,160,390,11,T),e.strokeStyle=R,e.shadowColor=R,e.strokeRect(280,140,460,220),e.fillStyle="#001100",e.fillRect(281,141,458,218),e.font="13px monospace",e.fillStyle=R,e.textAlign="left",e.shadowBlur=6,e.shadowColor=R;const o=i.text.split(" ");let n="",l=175;o.forEach(t=>{const s=n+t+" ";e.measureText(s).width>420?(e.fillText(n,298,l),n=t+" ",l+=22):n=s}),e.fillText(n,298,l);const a=Math.floor(r/25)%2===0;a&&(e.textAlign="right",e.fillStyle=T,e.fillText("[CLICK TO CONTINUE]",728,345));e.restore()}(r,0,S,s):"upgrade"===g.scene?function(e){e.save(),e.fillStyle="rgba(0,0,40,0.85)",e.fillRect(0,0,d,u),F(e,"UPGRADE TERMINAL",400,30,18,R),F(e,"[ React UI active \u2014 see panel ]",400,250,13,R),e.restore()}(r):"gameover"===g.scene?function(e,s){e.save(),e.fillStyle="rgba(0,0,0,0.85)",e.fillRect(0,0,d,u),$(e,"comandante",380,80);const r=Math.random()>.9?10*(Math.random()-.5):0;e.shadowBlur=20+10*Math.sin(.1*s),e.shadowColor="#ff0000",e.fillStyle="#ff2222",e.font="bold 32px monospace",e.textAlign="center",e.fillText("GAME OVER",400+r,200),e.shadowColor="#ff00ff",e.fillStyle=T,e.font="14px monospace",e.fillText('"GAME OVER, COMMANDER."',400,240),e.fillText('"THE CANDLES ARE OUT."',400,262),e.fillStyle=R,e.font="13px monospace",e.fillText("FINAL SCORE: ".concat(t.current.score),400,300);const i=Math.floor(s/30)%2===0;i&&(e.fillStyle=R,e.fillText("[CLICK TO INSERT COIN]",400,340));e.restore()}(r,s):"victory"===g.scene&&function(e,t,s){if(e.save(),s%20===0){const e=100+600*Math.random(),t=50+200*Math.random();for(let s=0;s<20;s++)c.current.explosions.push(new B(e,t,20+30*Math.random(),T,R,!0))}c.current.explosions.forEach(t=>{t.update(),t.draw(e)}),c.current.explosions=c.current.explosions.filter(e=>!e.dead),e.fillStyle="rgba(0,0,0,0.6)",e.fillRect(0,0,d,u),e.shadowBlur=20,e.shadowColor=R,e.fillStyle=R,e.font="bold 28px monospace",e.textAlign="center",e.fillText("COMANDANTE.EXE HAS STOPPED",400,160),e.shadowColor=E,e.fillStyle=E,e.font="16px monospace",e.fillText("CITIES SAVED. YOU ARE THE DEFENDER",400,210),e.fillText("OF THE NEON GRID.",400,232),e.shadowColor=T,e.fillStyle=T,e.font="bold 22px monospace",e.fillText("FINAL SCORE: ".concat(t.score),400,280),e.fillStyle=R,e.font="13px monospace";const r=Math.floor(s/30)%2===0;r&&e.fillText("[CLICK TO PLAY AGAIN]",400,340);e.restore()}(r,g,s),function(e){e.save(),e.globalAlpha=.06,e.fillStyle="#000000";for(let t=0;t<u;t+=3)e.fillRect(0,t,d,1);e.restore()}(r),r.restore(),l.current=requestAnimationFrame(e)}),()=>{f=!1,l.current&&cancelAnimationFrame(l.current)}},[]);const O=(0,r.useCallback)(e=>{const s=t.current,r=c.current;if("title"===s.scene)return r.storyScrollY=0,r.storyDone=!1,s.scene="story",i("story"),r.enemyMissiles=[],void(r.explosions=[]);if("story"===s.scene)return r.storyDone=!0,s.scene="playing",i("playing"),void g();if("wave_end"===s.scene){const e=s.wave;if([3,6,9,12].includes(e)){const t={3:{character:"briggs",name:"GEN. BRIGGS",text:'Commander, COMANDANTE just broadcast on every channel: "YOUR CITIES SPARKLE LIKE CANDLES. I WILL BLOW THEM OUT." What a drama queen. Keep those bases armed.'},6:{character:"pixel",name:"DR. PIXEL",text:"Bad news, Commander. COMANDANTE has hacked our decoy missile codes. Those fakes in the sky? That's our own tech turned against us. I'm working on a countermeasure. Buy me time."},9:{character:"briggs",name:"GEN. BRIGGS",text:'The EMP strikes are frying our systems. COMANDANTE is adapting. It said \u2014 and I quote \u2014 "I HAVE LEARNED YOUR PATTERNS, COMMANDER. YOU ARE PREDICTABLE." Rude. Prove it wrong.'},12:{character:"pixel",name:"DR. PIXEL",text:"I've located COMANDANTE's core \u2014 it's transmitting from an orbital satellite. If we survive long enough, I can upload a virus. Just... don't let the cities fall."}};r.cutsceneData=t[e],s.scene="cutscene",i("cutscene")}else s.scene="upgrade",i("upgrade");return}return"cutscene"===s.scene?(s.scene="upgrade",void i("upgrade")):"gameover"===s.scene?(t.current=W(),c.current={playerMissiles:[],enemyMissiles:[],explosions:[],aircraft:[],trucks:[],alerts:[],pendingEnemies:[],waveActive:!1,waveEndTimer:0,spawnTimer:0,storyScrollY:0,storyDone:!1,cutsceneStep:0,crosshair:{x:400,y:250},truckSpawnPending:!1,trucksDone:!1,waveEndScore:null,ammoDrops:[]},s.scene="title",void i("title")):"victory"===s.scene?(t.current=W(),c.current={playerMissiles:[],enemyMissiles:[],explosions:[],aircraft:[],trucks:[],alerts:[],pendingEnemies:[],waveActive:!1,waveEndTimer:0,spawnTimer:0,storyScrollY:0,storyDone:!1,cutsceneStep:0,crosshair:{x:400,y:250},truckSpawnPending:!1,trucksDone:!1,waveEndScore:null,ammoDrops:[]},t.current.scene="title",void i("title")):void("playing"===s.scene&&w(e))},[w,g]),D=(0,r.useCallback)(()=>{const e=t.current,s=c.current;e.wave++;const r=10+3*e.upgrades.extraAmmo;e.bases.forEach(e=>{e.alive&&(e.ammo=r)}),s.trucks=[],e.scene="playing",i("playing"),g(),e.wave>15&&setTimeout(()=>{t.current.scene="victory",i("victory")},3e3)},[g]),j=(0,r.useCallback)(function(e,s){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;const i=t.current;if(i.researchCredits<s)return;const o=i.upgrades[e];if("boolean"===typeof o){if(o)return;i.upgrades[e]=!0}else{if(o>=r)return;i.upgrades[e]=o+1}if(i.researchCredits-=s,"autoTurret"===e&&i.bases.forEach(e=>{e.alive&&(e.autoTurret=!0)}),"baseArmor"===e&&i.bases.forEach(e=>{e.alive&&(e.hasArmor=!0,e.armored=!1)}),"cityShield"===e){const e=i.cities.find(e=>e.alive&&!e.shielded);e&&(e.shielded=!0)}if("decoyCity"===e){const e=i.cities.find(e=>!e.alive);e&&(e.alive=!0,e.isDecoy=!0)}n({ts:Date.now()})},[]),I=(0,r.useCallback)(()=>{const e=t.current;if(e.researchCredits<1500)return;const s=e.cities.find(e=>!e.alive&&!e.isDecoy);s&&(e.researchCredits-=1500,s.alive=!0,s.shielded=!1,n({ts:Date.now()}))},[]),_=(0,r.useCallback)(()=>{const e=t.current;if(e.researchCredits<1e3)return;const s=e.bases.find(e=>!e.alive);s&&(e.researchCredits-=1e3,s.alive=!0,s.ammo=10+3*e.upgrades.extraAmmo,n({ts:Date.now()}))},[]);return(0,f.jsxs)("div",{style:{background:"#000",minHeight:"100vh",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",fontFamily:"monospace",userSelect:"none"},children:[(0,f.jsxs)("div",{style:{position:"relative"},children:[(0,f.jsx)("canvas",{ref:e,width:d,height:u,style:{display:"block",maxWidth:"100vw",cursor:"playing"===s?"crosshair":"pointer",border:"2px solid #ff00ff",boxShadow:"0 0 30px #ff00ff88, 0 0 60px #00ffff44"},onClick:O,onMouseMove:A}),"title"===s&&(0,f.jsxs)("div",{style:{position:"absolute",bottom:80,left:0,right:0,display:"flex",gap:20,justifyContent:"center"},children:[(0,f.jsx)(q,{onClick:O,color:"#ff00ff",children:"START GAME"}),(0,f.jsx)(q,{onClick:()=>{t.current.scene="howto",i("howto")},color:"#00ffff",children:"HOW TO PLAY"})]})]}),"howto"===s&&(0,f.jsx)("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,20,0.95)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:100},children:(0,f.jsxs)("div",{style:{border:"2px solid #00ffff",boxShadow:"0 0 20px #00ffff",padding:40,maxWidth:520,color:"#33ff33",fontFamily:"monospace"},children:[(0,f.jsx)("div",{style:{color:"#ff00ff",fontSize:22,marginBottom:20,textShadow:"0 0 10px #ff00ff"},children:"HOW TO PLAY"}),(0,f.jsx)(X,{icon:"\ud83d\uddb1\ufe0f",text:"CLICK anywhere above ground to launch a missile from the nearest base."}),(0,f.jsx)(X,{icon:"\ud83d\udca5",text:"Your missiles explode at the clicked point \u2014 detonate near enemies to destroy them."}),(0,f.jsx)(X,{icon:"\ud83c\udfd9\ufe0f",text:"Protect your 6 CITIES. Game over when all cities are destroyed."}),(0,f.jsx)(X,{icon:"\ud83d\ude80",text:"3 MISSILE BASES supply your ammo. Protect them \u2014 destroyed bases can't fire."}),(0,f.jsx)(X,{icon:"\ud83d\ude9b",text:"SUPPLY TRUCKS cross the map between waves, resupplying your bases. Protect them!"}),(0,f.jsx)(X,{icon:"\u26a1",text:"Beware EMP warheads \u2014 they disable bases. MIRV missiles split mid-flight!"}),(0,f.jsx)(X,{icon:"\ud83d\udd2c",text:"Spend RESEARCH CREDITS on upgrades between waves."}),(0,f.jsx)(X,{icon:"\ud83d\udcbe",text:"Survive 15 waves to defeat COMANDANTE."}),(0,f.jsx)(q,{style:{marginTop:24,width:"100%"},onClick:()=>{t.current.scene="title",i("title")},color:"#ff00ff",children:"BACK"})]})}),"upgrade"===s&&(0,f.jsx)(J,{gs:t.current,onDeploy:D,onBuy:j,onRebuildCity:I,onRebuildBase:_,uiData:o})]})}function q(e){let{onClick:t,color:s="#33ff33",children:i,style:o}=e;const[n,l]=(0,r.useState)(!1);return(0,f.jsx)("button",{onClick:t,onMouseEnter:()=>l(!0),onMouseLeave:()=>l(!1),style:c({background:n?s+"22":"transparent",border:"2px solid ".concat(s),color:s,fontFamily:"monospace",fontSize:14,padding:"10px 24px",cursor:"pointer",letterSpacing:2,boxShadow:n?"0 0 16px ".concat(s):"0 0 6px ".concat(s,"66"),transition:"all 0.15s",textShadow:"0 0 8px ".concat(s)},o),children:i})}function X(e){let{icon:t,text:s}=e;return(0,f.jsxs)("div",{style:{display:"flex",gap:12,marginBottom:14,alignItems:"flex-start"},children:[(0,f.jsx)("span",{style:{fontSize:18,minWidth:28},children:t}),(0,f.jsx)("span",{style:{fontSize:13,lineHeight:1.5,color:"#aaffaa"},children:s})]})}function J(e){let{gs:t,onDeploy:s,onBuy:i,onRebuildCity:o,onRebuildBase:n}=e;const[,l]=(0,r.useState)(0),a=()=>l(e=>e+1),c=t.researchCredits,d=e=>{let{label:s,desc:r,cost:o,upKey:n,maxLevel:l=1,onBuyFn:d}=e;const u=t.upgrades[n],h="boolean"===typeof u,p=h?u:u>=l,y=c>=o;return(0,f.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"6px 0",borderBottom:"1px solid #003300"},children:[(0,f.jsxs)("div",{children:[(0,f.jsx)("span",{style:{color:"#33ff33",fontSize:13},children:s}),!h&&(0,f.jsxs)("span",{style:{color:"#007700",fontSize:11,marginLeft:8},children:["[",u,"/",l,"]"]}),(0,f.jsx)("div",{style:{color:"#555",fontSize:11},children:r})]}),(0,f.jsx)("button",{onClick:()=>{(d||i)(n,o,l),a()},disabled:p||!y,style:{background:"transparent",border:"1px solid ".concat(p?"#333":y?"#33ff33":"#664400"),color:p?"#333":y?"#33ff33":"#664400",fontFamily:"monospace",fontSize:11,padding:"4px 10px",cursor:p?"default":y?"pointer":"not-allowed",minWidth:80},children:p?"MAXED":"".concat(o," CR")})]})};return(0,f.jsx)("div",{style:{position:"fixed",inset:0,background:"rgba(0,5,0,0.97)",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",zIndex:200,fontFamily:"monospace"},children:(0,f.jsxs)("div",{style:{width:780,maxHeight:"90vh",overflowY:"auto"},children:[(0,f.jsxs)("div",{style:{borderBottom:"2px solid #33ff33",paddingBottom:12,marginBottom:16,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,f.jsxs)("div",{children:[(0,f.jsx)("div",{style:{color:"#ff00ff",fontSize:20,textShadow:"0 0 10px #ff00ff"},children:"\u258cUPGRADE TERMINAL \u2590"}),(0,f.jsxs)("div",{style:{color:"#33ff33",fontSize:12,marginTop:4},children:["WAVE ",t.wave," COMPLETE \u2014 PREPARING WAVE ",t.wave+1]})]}),(0,f.jsxs)("div",{style:{textAlign:"right"},children:[(0,f.jsxs)("div",{style:{color:"#ff3399",fontSize:18,textShadow:"0 0 8px #ff3399"},children:[c," CR"]}),(0,f.jsx)("div",{style:{color:"#666",fontSize:11},children:"RESEARCH CREDITS"}),(0,f.jsxs)("div",{style:{color:"#33ff33",fontSize:14,marginTop:4},children:["SCORE: ",t.score]})]})]}),(0,f.jsxs)("div",{style:{display:"flex",gap:20,marginBottom:16,padding:"8px 12px",border:"1px solid #002200",background:"#001100"},children:[(0,f.jsxs)("div",{style:{color:"#00ffcc"},children:["CITIES: ",t.cities.map((e,t)=>(0,f.jsx)("span",{style:{marginLeft:4,color:e.alive?e.isDecoy?"#888800":"#00ffcc":"#330033"},children:e.alive?e.shielded?"\ud83d\udee1":e.isDecoy?"\u25c7":"\u25b2":"\u2715"},t))]}),(0,f.jsxs)("div",{style:{color:"#00ff66"},children:["BASES: ",t.bases.map((e,t)=>(0,f.jsx)("span",{style:{marginLeft:4,color:e.alive?"#00ff66":"#330000"},children:e.alive?"[".concat(e.ammo,"]"):"[\u2715]"},t))]})]}),(0,f.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:16},children:[(0,f.jsxs)(Z,{title:"\u2694 WEAPONS LAB",children:[(0,f.jsx)(d,{label:"BLAST RADIUS+",desc:"+20% explosion radius",cost:500,upKey:"blastRadius",maxLevel:3}),(0,f.jsx)(d,{label:"MISSILE SPEED+",desc:"Player missiles travel faster",cost:400,upKey:"missileSpeed",maxLevel:3}),(0,f.jsx)(d,{label:"CHAIN REACTION",desc:"25% chance secondary explosion",cost:1500,upKey:"chainReaction"}),(0,f.jsx)(d,{label:"DUAL WARHEAD",desc:"Each missile detonates twice",cost:2e3,upKey:"dualWarhead"}),(0,f.jsx)(d,{label:"AUTO-TURRET",desc:"Bases auto-fire at threats every 4s",cost:3e3,upKey:"autoTurret"})]}),(0,f.jsxs)(Z,{title:"\ud83d\udee1 DEFENSE LAB",children:[(0,f.jsx)(d,{label:"CITY SHIELD",desc:"Shield on one city (absorbs 1 hit)",cost:800,upKey:"cityShield",maxLevel:6}),(0,f.jsx)(d,{label:"BASE ARMOR",desc:"Bases survive one direct hit",cost:600,upKey:"baseArmor"}),(0,f.jsx)(d,{label:"EMP HARDENING",desc:"EMP recovery: 10s \u2192 3s",cost:1e3,upKey:"empHardening"}),(0,f.jsx)(d,{label:"DECOY CITY",desc:"Holographic city attracts missiles",cost:1200,upKey:"decoyCity"})]}),(0,f.jsxs)(Z,{title:"\ud83d\ude9b LOGISTICS",children:[(0,f.jsx)(d,{label:"EXTRA AMMO",desc:"+3 starting ammo per base",cost:300,upKey:"extraAmmo",maxLevel:4}),(0,f.jsx)(d,{label:"TRUCK ARMOR",desc:"Supply trucks survive one hit",cost:700,upKey:"truckArmor"}),(0,f.jsx)(d,{label:"FAST TRUCKS",desc:"Trucks move 50% faster",cost:500,upKey:"fastTrucks"}),(0,f.jsx)(d,{label:"TRUCK CAPACITY+",desc:"Trucks deliver +3 extra missiles/stop",cost:600,upKey:"truckCapacity",maxLevel:3})]}),(0,f.jsxs)(Z,{title:"\ud83d\udd27 REBUILD",children:[(0,f.jsxs)("div",{style:{padding:"6px 0",borderBottom:"1px solid #003300",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,f.jsxs)("div",{children:[(0,f.jsx)("span",{style:{color:"#33ff33",fontSize:13},children:"REBUILD CITY"}),(0,f.jsx)("div",{style:{color:"#555",fontSize:11},children:"Restore one destroyed city"}),(0,f.jsxs)("div",{style:{color:"#666",fontSize:11},children:["Destroyed: ",t.cities.filter(e=>!e.alive&&!e.isDecoy).length]})]}),(0,f.jsx)("button",{onClick:()=>{o(),a()},disabled:c<1500||!t.cities.some(e=>!e.alive&&!e.isDecoy),style:{background:"transparent",border:"1px solid #33ff33",color:"#33ff33",fontFamily:"monospace",fontSize:11,padding:"4px 10px",cursor:"pointer",minWidth:80},children:"1500 CR"})]}),(0,f.jsxs)("div",{style:{padding:"6px 0",borderBottom:"1px solid #003300",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,f.jsxs)("div",{children:[(0,f.jsx)("span",{style:{color:"#33ff33",fontSize:13},children:"REBUILD BASE"}),(0,f.jsx)("div",{style:{color:"#555",fontSize:11},children:"Restore one destroyed missile base"}),(0,f.jsxs)("div",{style:{color:"#666",fontSize:11},children:["Destroyed: ",t.bases.filter(e=>!e.alive).length]})]}),(0,f.jsx)("button",{onClick:()=>{n(),a()},disabled:c<1e3||!t.bases.some(e=>!e.alive),style:{background:"transparent",border:"1px solid #33ff33",color:"#33ff33",fontFamily:"monospace",fontSize:11,padding:"4px 10px",cursor:"pointer",minWidth:80},children:"1000 CR"})]})]})]}),(0,f.jsx)("div",{style:{marginTop:20,textAlign:"center"},children:(0,f.jsxs)(q,{onClick:s,color:"#ff00ff",style:{fontSize:16,padding:"14px 60px",letterSpacing:4},children:["\u25b6 DEPLOY WAVE ",t.wave+1]})})]})})}function Z(e){let{title:t,children:s}=e;return(0,f.jsxs)("div",{style:{border:"1px solid #003300",background:"#000800",padding:14},children:[(0,f.jsx)("div",{style:{color:"#ff3399",fontSize:13,marginBottom:10,textShadow:"0 0 8px #ff3399"},children:t}),s]})}function Q(){return(0,f.jsx)(V,{})}i.render((0,f.jsx)(r.StrictMode,{children:(0,f.jsx)(Q,{})}),document.getElementById("root"))})();
//# sourceMappingURL=main.bb7ccf1a.js.map